
<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>Android 集成 ijkplayer 编译及替换 cmake 方式编译 | what is your main focus for today?</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="ijkplayer 编译步骤：1.编译libijkffmpeg.so2.编译cpufeatures yuv_static ijkj4a静态库3.编译libijksdl.so4.编译android-ndk-profiler ijksoundtouch 静态库5.编译libijkplayer.so">
<meta name="keywords" content="FFmpeg,ijkplayer,cmake">
<meta property="og:type" content="article">
<meta property="og:title" content="Android 集成 ijkplayer 编译及替换 cmake 方式编译">
<meta property="og:url" content="http://yhaowa.gitee.io/yhaowa/13c2b04d/index.html">
<meta property="og:site_name" content="what is your main focus for today?">
<meta property="og:description" content="ijkplayer 编译步骤：1.编译libijkffmpeg.so2.编译cpufeatures yuv_static ijkj4a静态库3.编译libijksdl.so4.编译android-ndk-profiler ijksoundtouch 静态库5.编译libijkplayer.so">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-12-06T09:31:36.651Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android 集成 ijkplayer 编译及替换 cmake 方式编译">
<meta name="twitter:description" content="ijkplayer 编译步骤：1.编译libijkffmpeg.so2.编译cpufeatures yuv_static ijkj4a静态库3.编译libijksdl.so4.编译android-ndk-profiler ijksoundtouch 静态库5.编译libijkplayer.so">
  
    <link rel="alternative" href="/atom.xml" title="what is your main focus for today?" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/yhaowa/css/style.css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
</head></html>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/yhaowa/" id="logo">what is your main focus for today?</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/yhaowa/">首页</a>
        
          <a class="main-nav-link" href="/yhaowa/archives">归档</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="yhaowa.gitee.io/yhaowa">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main"><article id="post-Android-集成-ijkplayer-编译及替换-cmake-方式编译" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/yhaowa/13c2b04d/" class="article-date">
  <time datetime="2018-07-02T03:26:24.000Z" itemprop="datePublished">2018-07-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/yhaowa/categories/音视频/">音视频</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Android 集成 ijkplayer 编译及替换 cmake 方式编译
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>ijkplayer 编译步骤：<br>1.编译libijkffmpeg.so<br>2.编译cpufeatures yuv_static ijkj4a静态库<br>3.编译libijksdl.so<br>4.编译android-ndk-profiler ijksoundtouch 静态库<br>5.编译libijkplayer.so</p>
</blockquote>
<a id="more"></a>
<p>ijkplayer 的常规编译步骤记录：</p>
<p>编译并运行demo:<br>1.clone<br>git clone <a href="https://github.com/Bilibili/ijkplayer.git" target="_blank" rel="noopener">https://github.com/Bilibili/ijkplayer.git</a> ijkplayer-android<br>2.初始化，下载ffmpeg等源码<br>cd ijkplayer-android<br>./init-android.sh<br>3.编译ffmpeg（需要配置ANDROID_NDK,ANDROID_SDK环境变量）<br>cd android/contrib<br>./compile-ffmpeg.sh clean<br>./compile-ffmpeg.sh all<br>4.编译.so<br>cd ..<br>./compile-ijk.sh all<br>5.运行<br>AS打开 ijkplayer-android/android/ijkplayer 即可</p>
<p>ijk结构：<br>libijkffmpeg.so<br>libijksdl.so<br>libijkplayer.so</p>
<p>1.libijkplayer.so<br>LOCAL_SHARED_LIBRARIES := ijkffmpeg ijksdl<br>LOCAL_STATIC_LIBRARIES := android-ndk-profiler ijksoundtouch </p>
<p>2.libijksdl.so<br>LOCAL_SHARED_LIBRARIES := ijkffmpeg<br>LOCAL_STATIC_LIBRARIES := cpufeatures yuv_static ijkj4a</p>
<p>3.libijkffmpeg.so</p>
<p>MTXXVideoEditor步骤<br>1.cd videoeditor-generate_so/ffmpeg<br>2.sh compile.sh</p>
<p>j4a安装测试<br>1.git clone <a href="https://github.com/Bilibili/jni4android.git" target="_blank" rel="noopener">https://github.com/Bilibili/jni4android.git</a> jni4android<br>2.cd jni4android<br>3.</p>
<h1 id="build-dependencies"><a href="#build-dependencies" class="headerlink" title="build dependencies"></a>build dependencies</h1><h1 id="you-don’t-have-to-run-this-if-you-have-bison-3-x-installed"><a href="#you-don’t-have-to-run-this-if-you-have-bison-3-x-installed" class="headerlink" title="you don’t have to run this if you have bison 3.x installed"></a>you don’t have to run this if you have bison 3.x installed</h1><p>./get-deps.sh<br>报错：configure: error: no acceptable m4 could be found in $PATH<br>解决：<a href="http://blog.csdn.net/ldl22847/article/details/8575140" target="_blank" rel="noopener">http://blog.csdn.net/ldl22847/article/details/8575140</a><br>报错: Makefile:64: recipe for target ‘src/flex.j4a.yy.cpp’ failed    flex：命令未找到<br>解决：sudo apt-get install flex bison<br>4.<br>./configure<br>5.<br>make<br>报错：clang++：命令未找到<br>解决：sudo apt-get  install clang</p>
<p>ijkj4a:   cmake 没体现 ： $(call import-module,android/cpufeatures)， j4a中没有用到cpufeatures，为什么要导入？</p>
<p>libyuv:   大小不一样<br>cpufeatures: 什么时候生成的？  执行： ./compile-ijk.sh armv7a时生成 即 ndk-build ,关键语法：call import-module</p>
<pre><code>cmake中可以通过include(AndroidNdkModules)  android_ndk_import_module_cpufeatures() 导入，但导入后的模块为android.mk编译方式
解决方案：将这个模块源码拷贝到工程中，转为cmake编译方式，不再需要android_ndk_import_module_cpufeatures导入
</code></pre><p>静态库拷贝：</p>
<p>#是否需要从externalNativeBuild目录中拷贝静态库到输出目录, 设置为”true”时才会拷贝</p>
<p>#暂时用此方式解决静态库无法输出到指定目录的问题<br>set(static_cp<br>    “false”<br>)<br>if(${static_cp} STREQUAL “true”)<br>add_custom_command(TARGET ${lib_name}<br>POST_BUILD<br>COMMAND ${CMAKE_COMMAND} -E copy_if_different<br>${CMAKE_SOURCE_DIR}/.externalNativeBuild/cmake/debug/${ANDROID_ABI}/${lib_name}/lib${lib_name}.a<br>${CMAKE_SOURCE_DIR}/libs/${abi_library_name})<br>endif()</p>
<p>sdl编译问题：<br>x86成功编译，armv7a报错：Error:(201) undefined reference to ‘I422ToYUY2Row_NEON’  等等等等</p>
<p>查看对应的实现源文件，全部褐色</p>
<p>问题：set(cxx_flag<br>      ${cxx_flag}<br>      -DLIBYUV_NEON<br>      )<br>解决：set(cxx_flag<br>      ${cxx_flag}<br>      -LIBYUV_NEON<br>      )</p>
<p>application.h</p>
<p>ijkffmpeg.so 2.2M<br>ijkplayer 200+k<br>ijksdl 200+k</p>
<p>问题：<br>Error:Execution failed for task ‘:videoeditor-armv7a:transformNativeLibsWithMergeJniLibsForDebug’.</p>
<blockquote>
<p>More than one file was found with OS independent path ‘lib/armeabi-v7a/libijkplayer.so’<br>原因：<br>videoeditor_armv7a 为cmake工程，自动把gradle中的ijksdl、ijkplayer打到apk中了，与 jniLibs.srcDirs冲突<br>解决：<br>jniLibs.srcDirs只指向 libffmpeg.so </p>
</blockquote>
<p>IjkPlayer 源码是用 Android.mk 方式编译的，为了方便开发，需要将其编译方式替换为 CMake，过程中遇到了很多让人头疼的问题，好在最后还是成功替换了~<br>举个例子，在编译 IjkPlayer 源码中的 sdl 动态库时，其源码中的 Android.mk 方式如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">LOCAL_PATH := $(call my-dir)</span><br><span class="line"></span><br><span class="line"># 以预编译库的方式引入编译 sdl 库依赖的动态/静态库</span><br><span class="line">include $(CLEAR_VARS)</span><br><span class="line">LOCAL_MODULE := ijkffmpeg</span><br><span class="line">LOCAL_SRC_FILES := $(LOCAL_PATH)/../libffmpeg.so</span><br><span class="line">#LOCAL_SRC_FILES := /<span class="built_in">home</span>/yhao/ijkplayer-android/android/contrib/build/ffmpeg-armv7a/output/libijkffmpeg.so</span><br><span class="line">include $(PREBUILT_SHARED_LIBRARY)</span><br><span class="line">include $(CLEAR_VARS)</span><br><span class="line">LOCAL_MODULE := cpufeatures</span><br><span class="line">LOCAL_SRC_FILES := $(LOCAL_PATH)/../libcpufeatures.a</span><br><span class="line">include $(PREBUILT_STATIC_LIBRARY)</span><br><span class="line">include $(CLEAR_VARS)</span><br><span class="line">LOCAL_MODULE := yuv_static</span><br><span class="line">LOCAL_SRC_FILES := $(LOCAL_PATH)/../libyuv_static.a</span><br><span class="line">include $(PREBUILT_STATIC_LIBRARY)</span><br><span class="line">include $(CLEAR_VARS)</span><br><span class="line">LOCAL_MODULE := ijkj4a</span><br><span class="line">LOCAL_SRC_FILES := $(LOCAL_PATH)/../libijkj4a.a</span><br><span class="line">include $(PREBUILT_STATIC_LIBRARY)</span><br><span class="line">include $(CLEAR_VARS)</span><br><span class="line"></span><br><span class="line"># 编译选项</span><br><span class="line">LOCAL_CFLAGS += -<span class="built_in">std</span>=c99</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 需要链接的库</span><br><span class="line">LOCAL_LDLIBS += -llog -landroid -lOpenSLES -lEGL -lGLESv2</span><br><span class="line"></span><br><span class="line"># 需要引入的头文件</span><br><span class="line">sdl_dir=/<span class="built_in">home</span>/yhao/mtxxvideoeditor/videoeditor-generate_so/ijksdl</span><br><span class="line">ffmpeg_include_dir=/<span class="built_in">home</span>/yhao/mtxxvideoeditor/videoeditor-generate_so/ffmpeg/output/armv7a/include</span><br><span class="line">ijkyuv_include_dir=/<span class="built_in">home</span>/yhao/mtxxvideoeditor/videoeditor-generate_so/ijkyuv/include</span><br><span class="line">ijkj4a_include_dir=/<span class="built_in">home</span>/yhao/mtxxvideoeditor/videoeditor-generate_so/ijkj4a</span><br><span class="line">LOCAL_C_INCLUDES += $(sdl_dir)</span><br><span class="line">LOCAL_C_INCLUDES += $(realpath $(sdl_dir)/..)</span><br><span class="line">LOCAL_C_INCLUDES += $(ffmpeg_include_dir)</span><br><span class="line">LOCAL_C_INCLUDES += $(ijkyuv_include_dir)</span><br><span class="line">LOCAL_C_INCLUDES += $(ijkj4a_include_dir)</span><br><span class="line"></span><br><span class="line"># 需要编译的源码文件</span><br><span class="line">LOCAL_SRC_FILES += ijksdl_aout.c</span><br><span class="line">LOCAL_SRC_FILES += ijksdl_audio.c</span><br><span class="line">LOCAL_SRC_FILES += ijksdl_egl.c</span><br><span class="line">LOCAL_SRC_FILES += ijksdl_error.c</span><br><span class="line">LOCAL_SRC_FILES += ijksdl_mutex.c</span><br><span class="line">LOCAL_SRC_FILES += ijksdl_stdinc.c</span><br><span class="line">LOCAL_SRC_FILES += ijksdl_thread.c</span><br><span class="line">LOCAL_SRC_FILES += ijksdl_timer.c</span><br><span class="line">LOCAL_SRC_FILES += ijksdl_vout.c</span><br><span class="line">LOCAL_SRC_FILES += ijksdl_extra_log.c</span><br><span class="line">LOCAL_SRC_FILES += gles2/color.c</span><br><span class="line">LOCAL_SRC_FILES += gles2/common.c</span><br><span class="line">LOCAL_SRC_FILES += gles2/renderer.c</span><br><span class="line">LOCAL_SRC_FILES += gles2/renderer_rgb.c</span><br><span class="line">LOCAL_SRC_FILES += gles2/renderer_yuv420p.c</span><br><span class="line">LOCAL_SRC_FILES += gles2/renderer_yuv444p10le.c</span><br><span class="line">LOCAL_SRC_FILES += gles2/shader.c</span><br><span class="line">LOCAL_SRC_FILES += gles2/fsh/rgb.fsh.c</span><br><span class="line">LOCAL_SRC_FILES += gles2/fsh/yuv420p.fsh.c</span><br><span class="line">LOCAL_SRC_FILES += gles2/fsh/yuv444p10le.fsh.c</span><br><span class="line">LOCAL_SRC_FILES += gles2/vsh/mvp.vsh.c</span><br><span class="line">LOCAL_SRC_FILES += dummy/ijksdl_vout_dummy.c</span><br><span class="line">LOCAL_SRC_FILES += ffmpeg/ijksdl_vout_overlay_ffmpeg.c</span><br><span class="line">LOCAL_SRC_FILES += ffmpeg/abi_all/image_convert.c</span><br><span class="line">LOCAL_SRC_FILES += android/android_audiotrack.c</span><br><span class="line">LOCAL_SRC_FILES += android/android_nativewindow.c</span><br><span class="line">LOCAL_SRC_FILES += android/ijksdl_android_jni.c</span><br><span class="line">LOCAL_SRC_FILES += android/ijksdl_aout_android_audiotrack.c</span><br><span class="line">LOCAL_SRC_FILES += android/ijksdl_aout_android_opensles.c</span><br><span class="line">LOCAL_SRC_FILES += android/ijksdl_codec_android_mediacodec_dummy.c</span><br><span class="line">LOCAL_SRC_FILES += android/ijksdl_codec_android_mediacodec_internal.c</span><br><span class="line">LOCAL_SRC_FILES += android/ijksdl_codec_android_mediacodec_java.c</span><br><span class="line">LOCAL_SRC_FILES += android/ijksdl_codec_android_mediacodec.c</span><br><span class="line">LOCAL_SRC_FILES += android/ijksdl_codec_android_mediadef.c</span><br><span class="line">LOCAL_SRC_FILES += android/ijksdl_codec_android_mediaformat_java.c</span><br><span class="line">LOCAL_SRC_FILES += android/ijksdl_codec_android_mediaformat.c</span><br><span class="line">LOCAL_SRC_FILES += android/ijksdl_vout_android_nativewindow.c</span><br><span class="line">LOCAL_SRC_FILES += android/ijksdl_vout_android_surface.c</span><br><span class="line">LOCAL_SRC_FILES += android/ijksdl_vout_overlay_android_mediacodec.c</span><br><span class="line"></span><br><span class="line"># 依赖编译 sdl 库所需的动态/静态库</span><br><span class="line">LOCAL_SHARED_LIBRARIES := ijkffmpeg</span><br><span class="line">LOCAL_STATIC_LIBRARIES := cpufeatures yuv_static ijkj4a</span><br><span class="line"></span><br><span class="line">LOCAL_MODULE := ijksdl</span><br><span class="line">include $(BUILD_SHARED_LIBRARY)</span><br></pre></td></tr></table></figure>
<p>替换为 CMake 方式：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION <span class="number">3.4</span><span class="number">.1</span>)</span><br><span class="line"></span><br><span class="line"># 获取当前目录</span><br><span class="line"><span class="built_in">set</span>(pwd_dir  $&#123;CMAKE_SOURCE_DIR&#125;/ijksdl)</span><br><span class="line"></span><br><span class="line"># 设置库名称</span><br><span class="line"><span class="built_in">set</span>(lib_name ijksdl)</span><br><span class="line"></span><br><span class="line"># 获取库输出目录</span><br><span class="line"><span class="built_in">set</span>(lib_output_dir</span><br><span class="line">    $&#123;global_lib_output_dir&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># 设置静态库输出目录(参考googlesamples/android-ndk)</span><br><span class="line"><span class="built_in">set</span>(static_output</span><br><span class="line">    <span class="string">"false"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># 设置头文件</span><br><span class="line"><span class="built_in">set</span>(include_dir</span><br><span class="line">    $&#123;pwd_dir&#125;</span><br><span class="line">    $&#123;pwd_dir&#125;/..</span><br><span class="line">    $&#123;ffmpeg_output_include_dir&#125;</span><br><span class="line">    $&#123;CMAKE_SOURCE_DIR&#125;/ijkyuv/include</span><br><span class="line">    $&#123;CMAKE_SOURCE_DIR&#125;/ijkj4a</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># 以预编译库的方式引入编译 sdl 库依赖的动态/静态库</span><br><span class="line">add_library(cpufeatures-lib STATIC IMPORTED)</span><br><span class="line">set_target_properties(cpufeatures-lib PROPERTIES IMPORTED_LOCATION</span><br><span class="line">                       $&#123;lib_output_dir&#125;/libcpufeatures.a)</span><br><span class="line">add_library(yuv_static-lib STATIC IMPORTED)</span><br><span class="line">set_target_properties(yuv_static-lib PROPERTIES IMPORTED_LOCATION</span><br><span class="line">                       $&#123;lib_output_dir&#125;/libyuv_static.a)</span><br><span class="line">add_library(ijkj4a-lib STATIC IMPORTED)</span><br><span class="line">set_target_properties(ijkj4a-lib PROPERTIES IMPORTED_LOCATION</span><br><span class="line">                       $&#123;lib_output_dir&#125;/libijkj4a.a)</span><br><span class="line">add_library(ffmpeg-lib SHARED IMPORTED)</span><br><span class="line">set_target_properties(ffmpeg-lib PROPERTIES IMPORTED_LOCATION</span><br><span class="line">                      $&#123;ffmpeg_output_shared_lib&#125;)</span><br><span class="line"></span><br><span class="line"># 兼容gl版本</span><br><span class="line">message(FATAL_DEBUG <span class="string">"兼容gl版本 \</span></span><br><span class="line"><span class="string">                         (currently using $&#123;ANDROID_PLATFORM_LEVEL&#125;)."</span>)</span><br><span class="line"><span class="keyword">if</span> ($&#123;ANDROID_PLATFORM_LEVEL&#125; LESS <span class="number">12</span>)</span><br><span class="line">  message(FATAL_ERROR <span class="string">"OpenGL 2 is not supported before API level 11"</span>)</span><br><span class="line">  <span class="keyword">return</span>()</span><br><span class="line">elseif ($&#123;ANDROID_PLATFORM_LEVEL&#125; LESS <span class="number">18</span>)</span><br><span class="line">  message(FATAL_DEBUG <span class="string">"add_definitions DDYNAMIC_ES3 "</span>)</span><br><span class="line">  add_definitions(<span class="string">"-DDYNAMIC_ES3"</span>)</span><br><span class="line">  <span class="built_in">set</span>(GL3STUB_SRC  $&#123;pwd_dir&#125;/gles2/gl3stub.c)</span><br><span class="line">  <span class="built_in">set</span>(OPENGL_LIB GLESv2)</span><br><span class="line"><span class="keyword">else</span> ()</span><br><span class="line">  message(FATAL_DEBUG <span class="string">"GLESv3 无法提前获取gl版本，无法动态引入头文件，故平台版本需固定，低于18 "</span>)</span><br><span class="line">  <span class="built_in">set</span>(OPENGL_LIB GLESv3)</span><br><span class="line">endif ($&#123;ANDROID_PLATFORM_LEVEL&#125; LESS <span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">#将若干库链接到目标库文件</span><br><span class="line"><span class="built_in">set</span>(link_lib</span><br><span class="line">    $&#123;OPENGL_LIB&#125;</span><br><span class="line">    <span class="built_in">log</span></span><br><span class="line">    android</span><br><span class="line">    OpenSLES</span><br><span class="line">    EGL</span><br><span class="line">    ffmpeg-lib</span><br><span class="line">    cpufeatures-lib</span><br><span class="line">    yuv_static-lib</span><br><span class="line">    ijkj4a-lib</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">#设置编译选项</span><br><span class="line"><span class="built_in">set</span>(cmake_c_flag_debug</span><br><span class="line">    -<span class="built_in">std</span>=c99</span><br><span class="line">)</span><br><span class="line"><span class="built_in">set</span>(cmake_cxx_flag_debug</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># 设置要编译的源文件</span><br><span class="line"><span class="built_in">set</span>(source_files</span><br><span class="line">    $&#123;GL3STUB_SRC&#125;</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/gl_util.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/ff_ffmux_soft.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/ff_ffmux_hard.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/ff_print_util.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/ff_converter.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/ff_ffmusic_decode.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/ff_audio_converter.c</span><br><span class="line">    $&#123;pwd_dir&#125;/ijksdl_aout.c</span><br><span class="line">    $&#123;pwd_dir&#125;/ijksdl_audio.c</span><br><span class="line">    $&#123;pwd_dir&#125;/ijksdl_egl.c</span><br><span class="line">    $&#123;pwd_dir&#125;/ijksdl_error.c</span><br><span class="line">    $&#123;pwd_dir&#125;/ijksdl_mutex.c</span><br><span class="line">    $&#123;pwd_dir&#125;/ijksdl_stdinc.c</span><br><span class="line">    $&#123;pwd_dir&#125;/ijksdl_thread.c</span><br><span class="line">    $&#123;pwd_dir&#125;/ijksdl_timer.c</span><br><span class="line">    $&#123;pwd_dir&#125;/ijksdl_vout.c</span><br><span class="line">    $&#123;pwd_dir&#125;/ijksdl_extra_log.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/color.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/common.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/renderer.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/renderer_rgb.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/renderer_yuv420p.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/renderer_yuv444p10le.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/shader.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/fsh/rgb.fsh.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/fsh/yuv420p.fsh.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/fsh/yuv420pmeitu.fsh.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/fsh/yuv444p10le.fsh.c</span><br><span class="line">    $&#123;pwd_dir&#125;/gles2/vsh/mvp.vsh.c</span><br><span class="line">    $&#123;pwd_dir&#125;/dummy/ijksdl_vout_dummy.c</span><br><span class="line">    $&#123;pwd_dir&#125;/ffmpeg/ijksdl_vout_overlay_ffmpeg.c</span><br><span class="line">    $&#123;pwd_dir&#125;/ffmpeg/abi_all/image_convert.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/android_audiotrack.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/android_nativewindow.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/ijksdl_android_jni.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/ijksdl_aout_android_audiotrack.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/ijksdl_aout_android_opensles.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/ijksdl_codec_android_mediacodec_dummy.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/ijksdl_codec_android_mediacodec_internal.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/ijksdl_codec_android_mediacodec_java.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/ijksdl_codec_android_mediacodec.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/ijksdl_codec_android_mediadef.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/ijksdl_codec_android_mediaformat_java.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/ijksdl_codec_android_mediaformat.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/ijksdl_vout_android_nativewindow.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/ijksdl_vout_android_surface.c</span><br><span class="line">    $&#123;pwd_dir&#125;/android/ijksdl_vout_overlay_android_mediacodec.c</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 设置动态库输出路径</span><br><span class="line"><span class="built_in">set</span>(CMAKE_LIBRARY_OUTPUT_DIRECTORY $&#123;lib_output_dir&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 需要引入的头文件</span><br><span class="line">include_directories($&#123;include_dir&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 设置编译选项</span><br><span class="line"><span class="built_in">set</span>(CMAKE_C_FLAGS_DEBUG <span class="string">"$&#123;cmake_c_flag_debug&#125; -s"</span>)</span><br><span class="line"><span class="built_in">set</span>(CMAKE_CXX_FLAGS_DEBUG <span class="string">"$&#123;cmake_cxx_flag_debug&#125; -s"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 设置要编译的源文件</span><br><span class="line">add_library($&#123;lib_name&#125; SHARED $&#123;source_files&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 设置依赖的库</span><br><span class="line">target_link_libraries($&#123;lib_name&#125; $&#123;link_lib&#125;)</span><br><span class="line"></span><br><span class="line"># 是否需要输出静态库</span><br><span class="line"><span class="keyword">if</span>($&#123;static_output&#125; STREQUAL <span class="string">"true"</span>)</span><br><span class="line">set_target_properties($&#123;lib_name&#125;</span><br><span class="line">                      PROPERTIES</span><br><span class="line">                      ARCHIVE_OUTPUT_DIRECTORY</span><br><span class="line">                      $&#123;lib_output_dir&#125;)</span><br><span class="line">endif()</span><br></pre></td></tr></table></figure></p>
<p>CMake 编译方式中添加了一些兼容 gl 的处理及源文件，可以暂时忽略，语法上与 Android.mk 方式大同小异。<br>除了 sdl 库外，还需要编译 ijkyuv、ijk4a、ijkplayer 等库，这些库和 sdl 库同级目录，每个库中都需配置自己的 CMakeLists.txt 文件，在最外层的配置 CMakeLists.txt 文件中添加编译子目录，如下：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">add_subdirectory($&#123;CMAKE_SOURCE_DIR&#125;/cpufeatures)</span><br><span class="line">add_subdirectory($&#123;CMAKE_SOURCE_DIR&#125;/ijkj4a)</span><br><span class="line">add_subdirectory($&#123;CMAKE_SOURCE_DIR&#125;/ijkyuv)</span><br><span class="line">add_subdirectory($&#123;CMAKE_SOURCE_DIR&#125;/ijksdl)</span><br><span class="line">add_subdirectory($&#123;CMAKE_SOURCE_DIR&#125;/android-ndk-prof)</span><br><span class="line">add_subdirectory($&#123;CMAKE_SOURCE_DIR&#125;/ijksoundtouch)</span><br><span class="line">add_subdirectory($&#123;CMAKE_SOURCE_DIR&#125;/ijkplayer)</span><br></pre></td></tr></table></figure></p>
<p>然后在应用的 build.gradle 中指定最外层的 CMakeLists.txt 即可，另外也可以配置编译选项：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">defaultConfig &#123;</span><br><span class="line"></span><br><span class="line">        省略...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 配置编译选项</span></span><br><span class="line">        externalNativeBuild &#123;</span><br><span class="line">            cmake &#123;</span><br><span class="line">                cppFlags <span class="string">" -O3 -Wall -pipe "</span> +</span><br><span class="line">                        <span class="string">" -ffast-math "</span> +</span><br><span class="line">                        <span class="string">" -fstrict-aliasing -Werror=strict-aliasing"</span> +</span><br><span class="line">                        <span class="string">" -Wno-psabi -Wa,--noexecstack "</span> +</span><br><span class="line">                        <span class="string">" -DANDROID -DNDEBUG"</span></span><br><span class="line"></span><br><span class="line">                cFlags <span class="string">" -O3 -Wall -pipe "</span> +</span><br><span class="line">                        <span class="string">" -ffast-math "</span> +</span><br><span class="line">                        <span class="string">" -fstrict-aliasing -Werror=strict-aliasing"</span> +</span><br><span class="line">                        <span class="string">" -Wno-psabi -Wa,--noexecstack "</span> +</span><br><span class="line">                        <span class="string">" -DANDROID -DNDEBUG"</span></span><br><span class="line"></span><br><span class="line">                arguments <span class="string">"-DANDROID_STL=stlport_static"</span>,</span><br><span class="line">                        <span class="string">"-DANDROID_PIE=OFF"</span>,</span><br><span class="line">                        <span class="string">"-DANDROID_ARM_NEON=TRUE"</span>,</span><br><span class="line">                        <span class="string">"-DANDROID_PLATFORM=android-15"</span></span><br><span class="line"></span><br><span class="line">                targets <span class="string">"cpufeatures"</span>,</span><br><span class="line">                        <span class="string">"ijkj4a"</span>,</span><br><span class="line">                        <span class="string">"yuv_static"</span>,</span><br><span class="line">                        <span class="string">"ijksdl"</span>,</span><br><span class="line">                        <span class="string">"android-ndk-profiler"</span>,</span><br><span class="line">                        <span class="string">"ijksoundtouch"</span>,</span><br><span class="line">                        <span class="string">"ijkplayer"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ndk &#123;</span><br><span class="line">            abiFilters  'armeabi-v7a'</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>编译选项记录：<br>-Wall 是打开警告开关<br>-O1 提供基础级别的优化<br>-O2 提供更加高级的代码优化,会占用更长的编译时间<br>-O3 提供最高级的代码优化<br>-ffast-math 对于这些以速度为重的应用，该选项定义了预处理器宏 <strong>FAST_MATH</strong>, 指示编译不必遵循 IEEE 和 ISO 的浮点运算标准<br>-fstrict-aliasing 在编译选项中加入-fstrict-aliasing的优势在于向编译器说明不同类型的lvalue将指向不相关的内存区域，编译器可以做大量的优化。<br>-fno-strict-aliasing：在编译内核的编译选项CFLAGS中，加入了-fno-strict-aliasing，向编译器表明不同类型的lvalue可能指向相关的内存区域，<br> 因此编译器不会做出一些极端的优化而造成不安全（内核编译中优化选项为-O2, -O2优化时默认是-fstrict-aliasing，因此需要显式的指出编译参数是-fno-strict-aliasing）<br>-Werror=strict-aliasing : <a href="http://clhjoe.blogspot.hk/2012/06/gcc-strict-aliasing.html" target="_blank" rel="noopener">http://clhjoe.blogspot.hk/2012/06/gcc-strict-aliasing.html</a><br>-Wno-psabi 可以防止ndk-build编译时出现的警告。<br>-Wall 选项意思是编译后显示所有警告。<br>-W 选项类似-Wall，会显示警告，但是只显示编译器认为会出现错误的警告。</p>
<p>CMake 问题记录：<br>Q：编译 libyuv 库时报错：Error:(201) undefined reference to ‘I422ToYUY2Row_NEON’<br>A：编译选项 -DLIBYUV_NEON 改为 -LIBYUV_NEON，CMake 方式不同于 Android.mk 方式。<br>Q：相比与 Android.mk 方式，CMake 方式编译出的动态库体积很大，怎么办？<br>A：编译选项末尾加上 -s，形如： set(CMAKE_C_FLAGS_DEBUG “${cmake_c_flag_debug} -s”)，可去除冗余的二进制数据。</p>
<p>待续…</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://yhaowa.gitee.io/yhaowa/13c2b04d/" data-id="ckl20ibj00012h4cax4c7anwm" class="article-share-link" data-share="baidu" data-title="Android 集成 ijkplayer 编译及替换 cmake 方式编译">分享到</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/yhaowa/tags/FFmpeg/">FFmpeg</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/yhaowa/tags/cmake/">cmake</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/yhaowa/tags/ijkplayer/">ijkplayer</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/yhaowa/785f874e/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">
        
          Android 端音频变声方案
        
      </div>
    </a>
  
  
    <a href="/yhaowa/186751e8/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">ijkplayer 源码分析（上）</div>
    </a>
  
</nav>

  
</article>

</section>
      
      <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/yhaowa/categories/Android/">Android</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/yhaowa/categories/Framework/">Framework</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/yhaowa/categories/Java/">Java</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/yhaowa/categories/深度学习/">深度学习</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/yhaowa/categories/网络/">网络</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/yhaowa/categories/音视频/">音视频</a><span class="category-list-count">11</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/yhaowa/tags/ANativeWindow/" style="font-size: 10px;">ANativeWindow</a> <a href="/yhaowa/tags/APT/" style="font-size: 10px;">APT</a> <a href="/yhaowa/tags/Ashmem/" style="font-size: 10px;">Ashmem</a> <a href="/yhaowa/tags/Autolock/" style="font-size: 10px;">Autolock</a> <a href="/yhaowa/tags/BinderProxy/" style="font-size: 10px;">BinderProxy</a> <a href="/yhaowa/tags/BpBinder/" style="font-size: 10px;">BpBinder</a> <a href="/yhaowa/tags/BufferQueue/" style="font-size: 10px;">BufferQueue</a> <a href="/yhaowa/tags/COW/" style="font-size: 10px;">COW</a> <a href="/yhaowa/tags/Caffe/" style="font-size: 10px;">Caffe</a> <a href="/yhaowa/tags/FFmpeg/" style="font-size: 20px;">FFmpeg</a> <a href="/yhaowa/tags/Fmod/" style="font-size: 10px;">Fmod</a> <a href="/yhaowa/tags/GUI/" style="font-size: 10px;">GUI</a> <a href="/yhaowa/tags/Glide/" style="font-size: 10px;">Glide</a> <a href="/yhaowa/tags/Gralloc/" style="font-size: 10px;">Gralloc</a> <a href="/yhaowa/tags/HTTPS/" style="font-size: 10px;">HTTPS</a> <a href="/yhaowa/tags/IPCThreadState/" style="font-size: 10px;">IPCThreadState</a> <a href="/yhaowa/tags/JavaPoet/" style="font-size: 10px;">JavaPoet</a> <a href="/yhaowa/tags/LMK/" style="font-size: 10px;">LMK</a> <a href="/yhaowa/tags/Linux-IPC/" style="font-size: 10px;">Linux IPC</a> <a href="/yhaowa/tags/Linux-driver/" style="font-size: 10px;">Linux driver</a> <a href="/yhaowa/tags/Mutex/" style="font-size: 10px;">Mutex</a> <a href="/yhaowa/tags/OpenGL/" style="font-size: 12.5px;">OpenGL</a> <a href="/yhaowa/tags/ProcessState/" style="font-size: 10px;">ProcessState</a> <a href="/yhaowa/tags/RecycleView/" style="font-size: 12.5px;">RecycleView</a> <a href="/yhaowa/tags/Service-Manager/" style="font-size: 10px;">Service Manager</a> <a href="/yhaowa/tags/SoundTouch/" style="font-size: 10px;">SoundTouch</a> <a href="/yhaowa/tags/TCP/" style="font-size: 10px;">TCP</a> <a href="/yhaowa/tags/UDP/" style="font-size: 10px;">UDP</a> <a href="/yhaowa/tags/Ubuntu/" style="font-size: 10px;">Ubuntu</a> <a href="/yhaowa/tags/ViewModel/" style="font-size: 10px;">ViewModel</a> <a href="/yhaowa/tags/ams/" style="font-size: 10px;">ams</a> <a href="/yhaowa/tags/aop/" style="font-size: 10px;">aop</a> <a href="/yhaowa/tags/asm/" style="font-size: 10px;">asm</a> <a href="/yhaowa/tags/binder/" style="font-size: 15px;">binder</a> <a href="/yhaowa/tags/cmake/" style="font-size: 10px;">cmake</a> <a href="/yhaowa/tags/epoll/" style="font-size: 10px;">epoll</a> <a href="/yhaowa/tags/h264/" style="font-size: 10px;">h264</a> <a href="/yhaowa/tags/handler/" style="font-size: 12.5px;">handler</a> <a href="/yhaowa/tags/ijkplayer/" style="font-size: 15px;">ijkplayer</a> <a href="/yhaowa/tags/kotlin/" style="font-size: 10px;">kotlin</a> <a href="/yhaowa/tags/log/" style="font-size: 10px;">log</a> <a href="/yhaowa/tags/mmap/" style="font-size: 12.5px;">mmap</a> <a href="/yhaowa/tags/plugin/" style="font-size: 10px;">plugin</a> <a href="/yhaowa/tags/service/" style="font-size: 10px;">service</a> <a href="/yhaowa/tags/startActivity/" style="font-size: 10px;">startActivity</a> <a href="/yhaowa/tags/surface/" style="font-size: 10px;">surface</a> <a href="/yhaowa/tags/vsync/" style="font-size: 10px;">vsync</a> <a href="/yhaowa/tags/window/" style="font-size: 12.5px;">window</a> <a href="/yhaowa/tags/wms/" style="font-size: 10px;">wms</a> <a href="/yhaowa/tags/侧滑菜单/" style="font-size: 12.5px;">侧滑菜单</a> <a href="/yhaowa/tags/内部类/" style="font-size: 10px;">内部类</a> <a href="/yhaowa/tags/刘海屏适配/" style="font-size: 10px;">刘海屏适配</a> <a href="/yhaowa/tags/单例/" style="font-size: 10px;">单例</a> <a href="/yhaowa/tags/并发编程/" style="font-size: 10px;">并发编程</a> <a href="/yhaowa/tags/开发模式/" style="font-size: 10px;">开发模式</a> <a href="/yhaowa/tags/总结/" style="font-size: 10px;">总结</a> <a href="/yhaowa/tags/悬浮窗/" style="font-size: 10px;">悬浮窗</a> <a href="/yhaowa/tags/比特率/" style="font-size: 10px;">比特率</a> <a href="/yhaowa/tags/线程池/" style="font-size: 10px;">线程池</a> <a href="/yhaowa/tags/网络/" style="font-size: 10px;">网络</a> <a href="/yhaowa/tags/虚拟内存/" style="font-size: 10px;">虚拟内存</a> <a href="/yhaowa/tags/读书笔记/" style="font-size: 17.5px;">读书笔记</a> <a href="/yhaowa/tags/采样率/" style="font-size: 10px;">采样率</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/yhaowa/625d4c7c/">TCP/IP 网络协议知识点总结</a>
          </li>
        
          <li>
            <a href="/yhaowa/28077273/">Android APT 开发实践</a>
          </li>
        
          <li>
            <a href="/yhaowa/649d55e5/">Android Handler epoll 机制分析</a>
          </li>
        
          <li>
            <a href="/yhaowa/f9fd2518/">开发编写的 View 控件，是怎么变成屏幕上图像的？</a>
          </li>
        
          <li>
            <a href="/yhaowa/52cb86d4/">Android 消息屏障与异步消息</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="https://github.com/yhaolpz" target="_blank">我的「GitHub」</a>
          </li>
        
          <li>
            <a href="http://blog.csdn.net/yhaolpz" target="_blank">我的「CSDN」</a>
          </li>
        
          <li>
            <a href="https://moonshoter.github.io/" target="_blank">Moonshot</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Ahab<br>
      Powered by <a href="//hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/yhaowa/" class="mobile-nav-link">首页</a>
  
    <a href="/yhaowa/archives" class="mobile-nav-link">归档</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/yhaowa/img/scrollup.png"/></a>
</div>

<!-- totop end -->


<!-- 百度分享 start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="分享到新浪微博"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="分享到微信"></a>
    <a class="article-share-qq" data-cmd="sqq" title="分享到QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="分享到人人网"></a>
    <a class="article-share-more" data-cmd="more" title="更多"></a>
  </div>
</div>
<script>
  function SetShareData(cmd, config) {
    if (shareDataTitle && shareDataUrl) {
      config.bdText = shareDataTitle;
      config.bdUrl = shareDataUrl;
    }
    return config;
  }
  window._bd_share_config={
    "common":{onBeforeClick: SetShareData},
    "share":{"bdCustomStyle":"/yhaowa/css/bdshare.css"}
  };
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>


  <link rel="stylesheet" href="/yhaowa/fancybox/jquery.fancybox.css">
  <script src="/yhaowa/fancybox/jquery.fancybox.pack.js"></script>



<! -- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
                processEscapes: true
                    
}
  
        });
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
                  
}
    
        });
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Queue(function() {
            var all = MathJax.Hub.getAllJax(), i;
            for(i=0; i < all.length; i += 1) {
                            all[i].SourceElement().parentNode.className += ' has-jax';
                                    
            }
                
        });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<script src="/yhaowa/js/script.js"></script>

</div>
</body>
</html>
